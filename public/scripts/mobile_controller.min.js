(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.MobileController=function(){function e(e,s){this.header=e,this.ref=null!=s?s:null,this.onResize=t(this.onResize,this),this.closeStoreTab=t(this.closeStoreTab,this),this.openStore=t(this.openStore,this),this.closeStore=t(this.closeStore,this),this.setMobileInteractions=t(this.setMobileInteractions,this),this.setHeaderInteraction=t(this.setHeaderInteraction,this),this.body=$("body"),this.mobile_toolbar=this.header.find(".action-bar-mobile"),this.store_mobile_btn=this.mobile_toolbar.find("a.store"),this.map_mobile_btn=this.mobile_toolbar.find("a.map"),this.header_open_btn=this.header.find(".btn-menu"),this.has_toolbar=1===this.ref.length?!0:!1,this.header_height=this.header.height(),this.has_toolbar&&(this.general_content=this.ref.find(".toolbar-content"),this.stores_content=this.general_content.find(".stores-content"),this.filter_close_btn=this.stores_content.find(".close-filter"),this.stores_content_c=this.stores_content.find("#content"),this.stores_content_searchResult=this.stores_content.find("#content #wrapSearchResult"),this.stores_content_filterList=this.stores_content.find("#content #wrapFilterList"),this.search=this.stores_content.find(".search-wrapper"),this.search_height=parseInt(this.search.css("height")),this.stores_content_filterList.show(),this.stores_content.show(),this.setMobileInteractions()),this.setHeaderInteraction(),event_emitter.addListener("CLOSE_STORE_TAB",this.closeStoreTab)}return e.prototype.setHeaderInteraction=function(){var t=this;return this.header_open_btn.click(function(e){var s,n;return e.preventDefault(),t.body.toggleClass("menu-opened"),event_emitter.emitEvent("RESIZE_ALL"),t.has_toolbar?(n=t.stores_content_searchResult.hasClass("open"),s=t.stores_content_filterList.hasClass("open"),t.manual_menu=n||s?!0:!1):void 0})},e.prototype.setMobileInteractions=function(){var t=this;return this.map_mobile_btn.click(function(e){var s;return e.preventDefault(),s=$(e.currentTarget),s.addClass("active"),t.closeStore()}),this.store_mobile_btn.click(function(e){return e.preventDefault(),t.openStore()}),this.stores_content_searchResult.get(0).addEventListener("webkitTransitionEnd",function(e){var s,n;return e.stopPropagation(),n=$(e.currentTarget),s=n.hasClass("open"),s?void 0:t.ref.removeClass("open-content")},!1)},e.prototype.closeStore=function(){var t=this;return this.store_mobile_btn.removeClass("active"),this.stores_content_c.show("fast",function(){var e;return t.ref.addClass("open-content"),e=t.body.hasClass("menu-opened"),t.stores_content_searchResult.removeClass("open"),e&&!t.manual_menu?t.body.removeClass("menu-opened"):t.manual_menu=!1,"undefined"!=typeof store_list_iscroll&&null!==store_list_iscroll?store_list_iscroll.refresh():void 0})},e.prototype.openStore=function(){var t=this;return this.store_mobile_btn.addClass("active"),this.stores_content_c.show("fast",function(){var e;return t.ref.addClass("open-content"),e=t.body.hasClass("menu-opened"),t.stores_content_searchResult.addClass("open"),t.map_mobile_btn.hasClass("active")&&t.map_mobile_btn.removeClass("active"),e&&!t.manual_menu?t.body.removeClass("menu-opened"):t.manual_menu=!1,"undefined"!=typeof store_list_iscroll&&null!==store_list_iscroll?store_list_iscroll.refresh():void 0})},e.prototype.closeStoreTab=function(){return this.map_mobile_btn.click()},e.prototype.onResize=function(t,e){var s;return this.has_toolbar?(s=e-this.header_height-this.search_height,this.stores_content_c.css("height",""+s+"px"),this.stores_content_searchResult.css("height",""+s+"px"),this.stores_content_filterList.css("height",""+s+"px")):void 0},e}()}).call(this);